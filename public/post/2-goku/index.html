<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Define layer using Karabiner Elements togther with Goku | So</title><meta name=keywords content="goku,Karabiner Elements,keyboard"><meta name=description content="If you don&rsquo;t know the basic syntax of Goku, please see the offical tutorial.
What is Karabiner Elements? Karabiner Elements is a keyboard modifier on MacOS, which support key blindings remap and define layer, or in another form, complex modification. Download Karabiner Elements.
What is Goku? Goku is a config file that ease the configuration in Karabiner Elements. In Karabiner Elements, if you want to implement complex modification, you will need to edit the json file, which is wired, it is very likely loss for beginners who don&rsquo;t know the sturcture of modification of Karabiner Elements."><meta name=author content="Sokinpui"><link rel=canonical href=https://sokinpui.github.io/Blog/post/2-goku/><link crossorigin=anonymous href=/Blog/assets/css/stylesheet.min.d13dc9670c54a799901d8f51eb366234127600b84f76504283993a1e6bb2ffd7.css integrity="sha256-0T3JZwxUp5mQHY9R6zZiNBJ2ALhPdlBCg5k6Hmuy/9c=" rel="preload stylesheet" as=style><link rel=icon href=https://sokinpui.github.io/Blog/favicon.ico><link rel=apple-touch-icon href=https://sokinpui.github.io/Blog/apple-touch-icon.png><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta name=twitter:card content="summary"><meta name=twitter:title content="Define layer using Karabiner Elements togther with Goku | So"><meta name=twitter:description content="If you don&rsquo;t know the basic syntax of Goku, please see the offical tutorial.
What is Karabiner Elements? Karabiner Elements is a keyboard modifier on MacOS, which support key blindings remap and define layer, or in another form, complex modification. Download Karabiner Elements.
What is Goku? Goku is a config file that ease the configuration in Karabiner Elements. In Karabiner Elements, if you want to implement complex modification, you will need to edit the json file, which is wired, it is very likely loss for beginners who don&rsquo;t know the sturcture of modification of Karabiner Elements."><meta property="og:title" content="Define layer using Karabiner Elements togther with Goku | So"><meta property="og:description" content="If you don&rsquo;t know the basic syntax of Goku, please see the offical tutorial.
What is Karabiner Elements? Karabiner Elements is a keyboard modifier on MacOS, which support key blindings remap and define layer, or in another form, complex modification. Download Karabiner Elements.
What is Goku? Goku is a config file that ease the configuration in Karabiner Elements. In Karabiner Elements, if you want to implement complex modification, you will need to edit the json file, which is wired, it is very likely loss for beginners who don&rsquo;t know the sturcture of modification of Karabiner Elements."><meta property="og:type" content="article"><meta property="og:url" content="https://sokinpui.github.io/Blog/post/2-goku/"><meta property="og:image" content="https://sokinpui.github.io/Blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-03-31T17:27:25+08:00"><meta property="article:modified_time" content="2023-03-31T17:27:25+08:00"><meta property="og:site_name" content="So's blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sokinpui.github.io/Blog/post/"},{"@type":"ListItem","position":2,"name":"Define layer using Karabiner Elements togther with Goku","item":"https://sokinpui.github.io/Blog/post/2-goku/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Define layer using Karabiner Elements togther with Goku | So","name":"Define layer using Karabiner Elements togther with Goku","description":"If you don\u0026rsquo;t know the basic syntax of Goku, please see the offical tutorial.\nWhat is Karabiner Elements? Karabiner Elements is a keyboard modifier on MacOS, which support key blindings remap and define layer, or in another form, complex modification. Download Karabiner Elements.\nWhat is Goku? Goku is a config file that ease the configuration in Karabiner Elements. In Karabiner Elements, if you want to implement complex modification, you will need to edit the json file, which is wired, it is very likely loss for beginners who don\u0026rsquo;t know the sturcture of modification of Karabiner Elements.","keywords":["goku","Karabiner Elements","keyboard"],"wordCount":"909","inLanguage":"en","datePublished":"2023-03-31T17:27:25+08:00","dateModified":"2023-03-31T17:27:25+08:00","author":{"@type":"Person","name":"Sokinpui"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sokinpui.github.io/Blog/post/2-goku/"},"publisher":{"@type":"Organization","name":"So","logo":{"@type":"ImageObject","url":"https://sokinpui.github.io/Blog/favicon.ico"}}}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css integrity=sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js integrity=sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8590906017442858" crossorigin=anonymous></script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body class="type-post kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="auto",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://sokinpui.github.io/Blog/ accesskey=h title="So (Alt + H)">So</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://sokinpui.github.io/Blog/archives/ title=Archives>Archives</a></li><li><a href=https://sokinpui.github.io/Blog/post/ title=Post class=active>Post</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sokinpui.github.io/Blog/>Home</a>&nbsp;»&nbsp;<a href=https://sokinpui.github.io/Blog/post/>Posts</a></div><h1 class=post-title>Define layer using Karabiner Elements togther with Goku</h1><div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>March 31, 2023</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg>
<span class=post-tags><a href=https://sokinpui.github.io/Blog/tags/goku/>goku</a><a href=https://sokinpui.github.io/Blog/tags/karabiner-elements/>Karabiner Elements</a><a href=https://sokinpui.github.io/Blog/tags/keyboard/>keyboard</a></span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>5 min</span></span></div></header><div class="toc side left"><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what-is-karabiner-elements aria-label="What is Karabiner Elements?">What is Karabiner Elements?</a></li><li><a href=#what-is-goku aria-label="What is Goku?">What is Goku?</a></li><li><a href=#define-your-customized-layer aria-label="Define your customized layer">Define your customized layer</a><ul><li><a href=#1-why-define-layer aria-label="1. Why define layer">1. Why define layer</a></li><li><a href=#2-different-types-of-layers aria-label="2. Different types of layers">2. Different types of layers</a><ul><li><a href=#traditional-layers aria-label="Traditional layers">Traditional layers</a></li><li><a href=#simlayers aria-label=Simlayers>Simlayers</a></li></ul></li></ul></li><li><a href=#implement-layers-with-goku aria-label="Implement layers with Goku">Implement layers with Goku</a><ul><li><a href=#1-define-variables aria-label="1. define variables.">1. define variables.</a></li><li><a href=#2-mod-tap-layers aria-label="2. mod-tap Layers">2. mod-tap Layers</a></li><li><a href=#3-dead-keys aria-label="3. dead keys">3. dead keys</a></li><li><a href=#double-tap-layer aria-label="double tap layer">double tap layer</a></li><li><a href=#marco aria-label=Marco>Marco</a></li><li><a href=#my-karabieredn aria-label="My karabier.edn">My karabier.edn</a></li></ul></li></ul></div></details></div><div class=post-content><p>If you don&rsquo;t know the basic syntax of Goku, please see the <a href=https://github.com/yqrashawn/GokuRakuJoudo/blob/master/tutorial.md>offical
tutorial</a>.</p><h1 id=what-is-karabiner-elements>What is Karabiner Elements?<a hidden class=anchor aria-hidden=true href=#what-is-karabiner-elements>¶</a></h1><p>Karabiner Elements is a keyboard modifier on MacOS, which support key blindings
remap and define layer, or in another form, complex modification. <a href=https://karabiner-elements.pqrs.org/>Download
Karabiner Elements</a>.</p><h1 id=what-is-goku>What is Goku?<a hidden class=anchor aria-hidden=true href=#what-is-goku>¶</a></h1><p>Goku is a config file that ease the configuration in Karabiner Elements. In
Karabiner Elements, if you want to implement complex modification, you will need
to edit the json file, which is wired, it is very likely loss for beginners who
don&rsquo;t know the sturcture of modification of Karabiner Elements. Also, time is
limited, why don&rsquo;t use an easier tools that already on top of Karabiner Elements
to make life easier? <a href=https://github.com/yqrashawn/GokuRakuJoudo>Goku on
github</a></p><h1 id=define-your-customized-layer>Define your customized layer<a hidden class=anchor aria-hidden=true href=#define-your-customized-layer>¶</a></h1><h2 id=1-why-define-layer>1. Why define layer<a hidden class=anchor aria-hidden=true href=#1-why-define-layer>¶</a></h2><p>The functionality of keyboard can be exteneded, one way is to define your own
layers. With layers, you can shorten the key blindings in some &ldquo;shortcut&rdquo;
usually require pressing three to four keys together. Or build an symbols layer
if you stuck in the current <code>number + shift</code> way.</p><h2 id=2-different-types-of-layers>2. Different types of layers<a hidden class=anchor aria-hidden=true href=#2-different-types-of-layers>¶</a></h2><h3 id=traditional-layers>Traditional layers<a hidden class=anchor aria-hidden=true href=#traditional-layers>¶</a></h3><p>Traditional layers like the layers of QMK mod-tap feature, a key&rsquo;s function is
divide into two, when you held down, it is modifier, and you loss its tap&rsquo;s
function, and vice verse.</p><h3 id=simlayers>Simlayers<a hidden class=anchor aria-hidden=true href=#simlayers>¶</a></h3><p>In Goku, <strong>simlayer</strong>(simultianeous-layer) differ from traditional layers which
you would not loss key&rsquo;s original fucniton. <strong>For example, if you define <code>f</code> as
your simlayer, if you held down <code>f</code>, stream of <code>f</code> will be inserted. Conversely,
if you define <code>f</code> as tranditional layers, no <code>f</code> is insertd even you held it
down.</strong></p><p>In the
<a href=https://github.com/yqrashawn/GokuRakuJoudo/blob/master/tutorial.md>tutorial</a>
of goku, author states the problems of traditional layers. But to me, they are
the benefits, since simalayer have delayed display and require really fast right
key followed. So, in this page, I would suggest you to use traditional layers.</p><h1 id=implement-layers-with-goku>Implement layers with Goku<a hidden class=anchor aria-hidden=true href=#implement-layers-with-goku>¶</a></h1><h2 id=1-define-variables>1. define variables.<a hidden class=anchor aria-hidden=true href=#1-define-variables>¶</a></h2><p>Variable help karabiner element know the state of your keyboard to act in
performs different events in each states.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=s2>&#34;name of variable&#34;</span> <span class=mi>0</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></div><p>It is a sturcture of variable, doble quoted name, 0 or 1 state.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[:</span><span class=n>fookey</span>   <span class=p>[</span><span class=s2>&#34;foovar-set&#34;</span> <span class=mi>0</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span>   <span class=p>[</span><span class=s2>&#34;foovar-cd&#34;</span> <span class=mi>0</span><span class=o>/</span><span class=mi>1</span><span class=p>]]</span>
</span></span></code></pre></div><p>It is conditional event, the last one is the condition, the middle one is <code>to event</code>, which set <code>foovar-set</code> to 0 or 1 if the condition is met.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[:</span><span class=n>fookey</span>   <span class=p>[[</span><span class=s2>&#34;foovar1&#34;</span> <span class=mi>0</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>[</span><span class=s2>&#34;foovar2&#34;</span> <span class=mi>0</span><span class=o>/</span><span class=mi>1</span><span class=p>]]</span>     <span class=p>[</span><span class=s2>&#34;foovar&#34;</span> <span class=mi>0</span><span class=o>/</span><span class=mi>1</span><span class=p>]]</span>
</span></span></code></pre></div><p>It is same strcture of above but with extended <code>to event</code>, which set two
variable in sequence, the condition part can also be extened in vector <code>[["foo1" 1] ["foo2" 1]]</code>, vector can expand as much as you want.</p><h2 id=2-mod-tap-layers>2. mod-tap Layers<a hidden class=anchor aria-hidden=true href=#2-mod-tap-layers>¶</a></h2><p>This type of layer active if you held down fookey. inactive if you release.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[:</span><span class=n>w</span> <span class=p>[</span><span class=s2>&#34;tap_fookey&#34;</span> <span class=mi>1</span><span class=p>]</span> <span class=n>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=p>:</span><span class=n>alone</span> <span class=p>[:</span><span class=n>w</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=p>:</span><span class=n>afterup</span> <span class=p>[</span><span class=s2>&#34;tap_fookey&#34;</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>:</span><span class=n>tap_fookey</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>period</span>  <span class=p>:</span><span class=mi>1</span>  <span class=p>]</span>
</span></span></code></pre></div><p>The first <code>["tap_fookey" 1]</code> is the key event if you held down, <code>alone</code> is the
key event if you tap single. <code>:afterup</code> is after key up event. The last line
<code>:tap_fookey</code> tells karabiner to perform the following events if <code>"tap_fookey"</code>
is met, In this example, it is <code>w+. -> 1</code> it is like the conditions.</p><h2 id=3-dead-keys>3. dead keys<a hidden class=anchor aria-hidden=true href=#3-dead-keys>¶</a></h2><p>This type of layer active if you press fookeys, inactive if you press the
fooleavekey.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[:</span><span class=n>fookey</span>            <span class=p>[</span><span class=s2>&#34;dead_foo&#34;</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>fooleavekey</span>       <span class=p>[</span><span class=s2>&#34;dead_foo&#34;</span> <span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=p>:</span><span class=n>dead_foo</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>foo_from</span>       <span class=p>[:</span><span class=n>foo_to</span> <span class=p>[</span><span class=s2>&#34;dead_foo&#34;</span> <span class=mi>0</span><span class=p>]]]</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>foo_from</span>       <span class=p>:</span><span class=n>foo_to</span> <span class=p>]</span>
</span></span></code></pre></div><p>Dead key is actually a simple layer checked with variales state, the first event
in dead_foo will leave layer after press the <code>foo_from</code>, while the second
won&rsquo;t.
If you wish to leave the layer with the same keys you can:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[:</span><span class=n>comma</span>  <span class=p>[</span><span class=s2>&#34;taped&#34;</span> <span class=mi>0</span><span class=p>]</span>  <span class=p>[</span><span class=s2>&#34;taped&#34;</span> <span class=mi>1</span> <span class=p>]</span> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>comma</span>  <span class=p>[</span><span class=s2>&#34;taped&#34;</span> <span class=mi>1</span><span class=p>]</span>  <span class=p>[</span><span class=s2>&#34;taped&#34;</span> <span class=mi>0</span> <span class=p>]</span> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>:</span><span class=n>taped</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>period</span>  <span class=p>:</span><span class=mi>1</span>  <span class=p>]</span>
</span></span></code></pre></div><h2 id=double-tap-layer>double tap layer<a hidden class=anchor aria-hidden=true href=#double-tap-layer>¶</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>;;</span> <span class=n>check</span> <span class=n>double</span> <span class=n>tap</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>right_shift</span>  <span class=p>[</span><span class=s2>&#34;two&#34;</span> <span class=mi>1</span><span class=p>]</span>  <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;;</span> <span class=n>chekc</span> <span class=n>single</span> <span class=n>tap</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>right_shift</span> <span class=p>:</span><span class=n>right_shift</span> <span class=n>nil</span>
</span></span><span class=line><span class=cl>    <span class=p>{:</span><span class=n>alone</span>  <span class=p>[:</span><span class=n>right_shift</span> <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>:</span><span class=n>delayed</span> <span class=p>{:</span><span class=n>invoked</span> <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>0</span><span class=p>]</span> <span class=p>:</span><span class=n>canceled</span> <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>0</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>    <span class=p>:</span><span class=n>params</span> <span class=p>{:</span><span class=n>delay</span> <span class=mi>1000</span><span class=p>}}]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>:</span><span class=n>two</span>
</span></span><span class=line><span class=cl><span class=p>[:</span><span class=n>period</span>  <span class=p>:</span><span class=mi>1</span>  <span class=p>]</span>
</span></span></code></pre></div><p>This layer keep the function of <code>right shift</code>, but I don&rsquo;t know why it fail to
use <code>right shift</code> to escape.
The single tap check is a little bit complicate, nil is introduced in mod-tap
layer which extended the <code>to event</code>, new <code>:delayed</code> control the behaviour after
the key tapped, <code>:invoked</code> and <code>:canceled</code> work as their name. <code>:params {:delay 1000}</code> denote the time for the accepted delay time, <code>invoked</code> event trigger
before that time, <code>canceled</code> event trigger after that time.
<strong>The double tap check should be put before single tap check.</strong>
To escape the layer use the same key use the follow snippet instead:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=p>;;</span> <span class=n>check</span> <span class=n>double</span> <span class=n>tap</span>
</span></span><span class=line><span class=cl>    <span class=p>[:</span><span class=n>right_shift</span>  <span class=p>[</span><span class=s2>&#34;two&#34;</span> <span class=mi>1</span><span class=p>]</span>  <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=p>;;</span> <span class=n>chekc</span> <span class=n>single</span> <span class=n>tap</span>
</span></span><span class=line><span class=cl>    <span class=p>[:</span><span class=n>right_shift</span> <span class=p>[:</span><span class=n>right_shift</span> <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>1</span><span class=p>]]</span> <span class=p>[</span><span class=s2>&#34;two&#34;</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>{:</span><span class=n>delayed</span> <span class=p>{:</span><span class=n>invoked</span> <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>0</span><span class=p>]</span> <span class=p>:</span><span class=n>canceled</span> <span class=p>[</span><span class=s2>&#34;one&#34;</span> <span class=mi>0</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>        <span class=p>:</span><span class=n>params</span> <span class=p>{:</span><span class=n>delay</span> <span class=mi>1000</span><span class=p>}}]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>:</span><span class=n>two</span>
</span></span><span class=line><span class=cl>    <span class=p>[:</span><span class=n>right_shift</span>  <span class=p>[</span><span class=s2>&#34;two&#34;</span> <span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>[:</span><span class=n>period</span>  <span class=p>:</span><span class=mi>1</span>  <span class=p>]</span>
</span></span></code></pre></div><p>It first check that if right_shift is tap twice and once, and leave if tap twice
already. But this cannot perserve the function of <code>right shift</code>, so it cannnot
be act like modifier anymore, to be noted, the last example that perserve <code>right shift</code> can replace by othey with variables, so as mod-tap layer and double
tapped layer at the same time.</p><h2 id=marco>Marco<a hidden class=anchor aria-hidden=true href=#marco>¶</a></h2><p>This is actually not a layer, but a collection of keys. I have defined a layer
to shorten repetitive keys sequence into single press.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[:</span><span class=n>i</span>     <span class=p>[:</span><span class=n>i</span> <span class=p>:</span><span class=n>n</span> <span class=p>:</span><span class=n>s</span> <span class=p>:</span><span class=n>e</span> <span class=p>:</span><span class=n>r</span> <span class=p>:</span><span class=n>t</span> <span class=p>:</span><span class=n>spacebar</span> <span class=p>:</span><span class=n>a</span> <span class=p>:</span><span class=n>spacebar</span> <span class=p>:</span><span class=n>j</span> <span class=p>:</span><span class=n>o</span> <span class=p>:</span><span class=n>k</span> <span class=p>:</span><span class=n>e</span><span class=p>]]</span> 
</span></span></code></pre></div><p>Which will insert <code>insert a joke</code> with space if you press <code>i</code>.</p><h2 id=my-karabieredn>My karabier.edn<a hidden class=anchor aria-hidden=true href=#my-karabieredn>¶</a></h2><p>Here is a
<a href=https://github.com/sokinpui/config/blob/main/karabiner.edn>reference</a> for your
own implementation.</p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://sokinpui.github.io/Blog/post/kmonad/3-dyn-num-sym/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></svg>&nbsp;Prev Page</span><br><span>Dynamic number-symbol row in vim</span></a>
<a class=next href=https://sokinpui.github.io/Blog/post/1-layout/><span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>Programmer MacBook Keyboard layout</span></a></nav></footer><div class=comments-separator></div></article></main><footer class=footer><span>&copy; 2023 <a href=https://sokinpui.github.io/Blog/>So</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a></span>
<span style=display:inline-block;margin-left:1em>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n="1"=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/Blog/js/medium-zoom.min.js data-no-instant></script>
<script>(function(){const a="1"=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script><script src=/Blog/js/instantclick.min.js data-no-instant></script>
<script data-no-instant>InstantClick.init()</script></body></html>